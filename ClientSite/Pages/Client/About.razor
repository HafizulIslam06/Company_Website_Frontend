@page "/about"
@using ClientSite.Models
@using ClientSite.Services
@inject AboutService AboutService
@using ClientSite.Pages.Components

@code {
    private AboutSection? aboutSection;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            // Assuming only one section
            var sections = await AboutService.GetAboutSectionsAsync();
            aboutSection = sections.FirstOrDefault();
        }
        finally
        {
            isLoading = false;
        }
    }
}

<section class="about-section py-5">
    <div class="container">
        @* Dynamic Content *@
        @if (isLoading)
        {
            <p class="text-center text-primary">Loading...</p>
        }
        else if (aboutSection == null)
        {
            <p class="text-center text-danger">About section not available.</p>
        }
        else
        {
            <!-- Header -->
            <div class="text-center mb-5">
                <h2 class="fw-bold display-4 text-primary">
                    About <span class="text-gradient">Bits Bangla</span>
                </h2>
                <p class="lead text-muted w-75 mx-auto" style="font-size:1.2rem; line-height:1.8;">
                    @aboutSection.Description
                </p>
            </div>

            <!-- Story with Video -->
            <div class="row align-items-center mb-5">
                <!-- Video -->
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <div class="video-wrapper position-relative rounded-4 overflow-hidden shadow-lg">
                        @if (!string.IsNullOrEmpty(aboutSection.ImageUrl))
                        {
                            <img src="@aboutSection.ImageUrl" alt="@aboutSection.Title" class="img-fluid w-100" />
                        }
                        @if (!string.IsNullOrEmpty(aboutSection.VideoUrl))
                        {
                            <button class="play-btn position-absolute top-50 start-50 translate-middle rounded-circle shadow"
                                    data-bs-toggle="modal" data-bs-target="#aboutVideoModal">
                                <i class="bi bi-play-fill fs-2 text-white"></i>
                            </button>
                        }
                    </div>
                </div>

                <!-- Story Text -->
                <div class="col-lg-6">
                    <h3 class="fw-bold text-primary mb-3">@aboutSection.Title</h3>
                    <p class="text-muted" style="font-size:1.1rem; line-height:1.7;">
                        We are a Bangladeshi tech company crafting intelligent, scalable, and beautiful digital solutions.
                        Helping businesses go from ideas to impact.
                    </p>
                    <a href="/contact" class="btn btn-primary rounded-pill mt-3 px-4 py-2">
                        <i class="bi bi-envelope-paper me-2"></i> Get in Touch
                    </a>
                </div>
            </div>

            <!-- Stats -->
            <div class="row text-center mb-5">
                <div class="col-md-4 mb-3">
                    <div class="p-4 bg-gradient-primary text-white rounded-4 shadow">
                        <h3 class="fw-bold">4+</h3>
                        <p>Years of Experience</p>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="p-4 bg-gradient-success text-white rounded-4 shadow">
                        <h3 class="fw-bold">100+</h3>
                        <p>Projects Completed</p>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="p-4 bg-gradient-warning text-white rounded-4 shadow">
                        <h3 class="fw-bold">50+</h3>
                        <p>Happy Clients</p>
                    </div>
                </div>
            </div>
        }             
    </div>
</section>

<div class="bg-light">
    <WhyChooseUs />
</div>

<Products />

<!-- Contact Section -->
<div class="contact-cta py-5 text-center rounded-4 shadow-lg position-relative overflow-hidden mt-5" style="background: linear-gradient(120deg, #6610f2, #007bff); color:white;">
    <div class="position-absolute top-0 start-0 w-100 h-100"
            style="background: radial-gradient(circle at 30% 50%, rgba(255,255,255,0.15), transparent 70%);">
    </div>
    <div class="position-relative">
        <h2 class="fw-bold mb-3">Let’s Build the Future Together 🚀</h2>
        <p class="lead mb-4 text-light">Have an idea or project in mind? Let’s make it happen with innovation, speed, and impact.</p>
        <a href="/contact" class="btn btn-light btn-lg rounded-pill fw-bold px-5">
            <i class="bi bi-chat-dots me-2"></i> Contact Us
        </a>
    </div>
</div>

@if (!string.IsNullOrEmpty(aboutSection?.VideoUrl))
{
    <!-- Video Modal -->
    <div class="modal fade" id="aboutVideoModal" tabindex="-1" aria-labelledby="aboutVideoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content border-0 rounded-4 overflow-hidden">
                <div class="ratio ratio-16x9">
                    <iframe id="aboutVideo" src="@aboutSection.VideoUrl"
                            title="@aboutSection.Title"
                            allow="autoplay; encrypted-media"
                            allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>
}


<style>
    .text-gradient {
        background: linear-gradient(90deg, #007bff, #6610f2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .bg-gradient-primary {
        background: linear-gradient(135deg, #0d6efd, #6610f2);
    }

    .bg-gradient-success {
        background: linear-gradient(135deg, #198754, #0dcaf0);
    }

    .bg-gradient-warning {
        background: linear-gradient(135deg, #ffc107, #fd7e14);
    }

    .video-wrapper {
        transition: transform 0.3s ease;
    }

        .video-wrapper:hover {
            transform: scale(1.03);
        }

    .play-btn {
        width: 75px;
        height: 75px;
        background: rgba(0, 123, 255, 0.8);
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s;
    }

        .play-btn:hover {
            background: rgba(0, 123, 255, 1);
        }
</style>